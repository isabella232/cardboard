<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Cardboard][1]
    -   [Parameters][2]
    -   [Examples][3]
-   [addFeature][4]
    -   [Parameters][5]
-   [updateFeature][6]
    -   [Parameters][7]
-   [deleteFeature][8]
    -   [Parameters][9]
-   [applyChanges][10]
    -   [Parameters][11]
-   [put][12]
    -   [Parameters][13]
-   [remove][14]
    -   [Parameters][15]
-   [cardboard][16]
    -   [put][17]
        -   [Parameters][18]
        -   [Examples][19]
    -   [del][20]
        -   [Parameters][21]
        -   [Examples][22]
    -   [get][23]
        -   [Parameters][24]
        -   [Examples][25]
    -   [createTable][26]
        -   [Parameters][27]
        -   [Examples][28]
    -   [delDataset][29]
        -   [Parameters][30]
    -   [list][31]
        -   [Parameters][32]
        -   [Examples][33]
    -   [listDatasets][34]
        -   [Parameters][35]
        -   [Examples][36]
    -   [getDatasetInfo][37]
        -   [Parameters][38]
        -   [Examples][39]
    -   [calculateDatasetInfo][40]
        -   [Parameters][41]
        -   [Examples][42]
    -   [bboxQuery][43]
        -   [Parameters][44]
        -   [Examples][45]
-   [cardboard.metadata][46]
-   [utils][47]
    -   [resolveFeatures][48]
        -   [Parameters][49]
    -   [toDatabaseRecord][50]
        -   [Parameters][51]
    -   [idFromRecord][52]
        -   [Parameters][53]
-   [cardboard.batch][54]

## Cardboard

[index.js:37-620][55]

Cardboard client generator

### Parameters

-   `config` **[object][56]** a configuration object
    -   `config.table` **[string][57]** the name of a DynamoDB table to connect to
    -   `config.region` **[string][57]** the AWS region containing the DynamoDB table
    -   `config.bucket` **[string][57]** the name of an S3 bucket to use
    -   `config.prefix` **[string][57]** the name of a folder within the indicated S3 bucket
    -   `config.dyno` **dyno?** a pre-configured [dyno client][58] for connecting to DynamoDB
    -   `config.s3` **s3?** a pre-configured [S3 client][59]

### Examples

```javascript
var cardboard = require('cardboard')({
  table: 'my-cardboard-table',
  region: 'us-east-1',
  bucket: 'my-cardboard-bucket',
  prefix: 'my-cardboard-prefix'
});
```

```javascript
var cardboard = require('cardboard')({
  dyno: require('@mapbox/dyno')(dynoConfig),
  bucket: 'my-cardboard-bucket',
  prefix: 'my-cardboard-prefix'
});
```

Returns **[cardboard][60]** a cardboard client

## addFeature

[index.js:501-503][61]

Incrementally update a dataset's metadata with a new feature. This operation **will** create a metadata record if one does not exist.

### Parameters

-   `dataset` **[string][57]** the name of the dataset
-   `feature` **[object][56]** a GeoJSON feature (or backend record) being added to the dataset
-   `callback` **[function][62]** a function to handle the response

## updateFeature

[index.js:515-517][63]

Update a dataset's metadata with a change to a single feature. This operation **will not** create a metadata record if one does not exist.

### Parameters

-   `dataset` **[string][57]** the name of the dataset
-   `from` **[object][56]** a GeoJSON feature (or backend record) representing the state of the feature _before_ the update
-   `to` **[object][56]** a GeoJSON feature (or backend record) representing the state of the feature _after_ the update
-   `callback` **[function][62]** a function to handle the response

## deleteFeature

[index.js:527-529][64]

Given a GeoJSON feature to remove, perform all required metadata updates. This operation **will not** create a metadata record if one does not exist. This operation **will not** shrink metadata bounds.

### Parameters

-   `dataset` **[string][57]** the name of the dataset
-   `feature` **[object][56]** a GeoJSON feature (or backend record) to remove from the dataset
-   `callback` **[function][62]** a function to handle the response

## applyChanges

[index.js:539-541][65]

Perform all required metadata updates for a set of changes to features in a dataset. This operation **will** create a metadata record if one does not exist.

### Parameters

-   `dataset` **[string][57]** the name of the dataset
-   `changes` **[array][66]** a set of changes. Each change must have an `.action` property, and `.new`, `.old`, or both.
-   `callback` **[function][62]** a function fired when all changes have been implemented

## put

[lib/batch.js:33-80][67]

Insert or update a set of GeoJSON features

### Parameters

-   `collection` **[object][56]** a GeoJSON FeatureCollection containing features to insert and/or update
-   `dataset` **[string][57]** the name of the dataset that these features belongs to
-   `callback` **[function][62]** the callback function to handle the response

## remove

[lib/batch.js:90-111][68]

Remove a set of features

### Parameters

-   `ids` **[Array][66]&lt;[string][57]>** an array of feature ids to remove
-   `dataset` **[string][57]** the name of the dataset that these features belong to
-   `callback` **[function][62]** the callback function to handle the response

## cardboard

[index.js:55-55][69]

A client configured to interact with a backend cardboard database

### put

[index.js:115-128][70]

Insert or update a single GeoJSON feature

#### Parameters

-   `feature` **[object][56]** a GeoJSON feature
-   `dataset` **[string][57]** the name of the dataset that this feature belongs to
-   `callback` **[function][62]** the callback function to handle the response

#### Examples

```javascript
// Create a point, allowing Cardboard to assign it an id.
var feature = {
  type: 'Feature',
  properties: {},
  geometry: {
    type: 'Point',
    coordinates: [0, 0]
  }
};

cardboard.put(feature, 'my-dataset', function(err, result) {
  if (err) throw err;
  !!result.id; // true: an id has been assigned
});
```

```javascript
// Create a point, using a custom id.
var feature = {
  id: 'my-custom-id',
  type: 'Feature',
  properties: {},
  geometry: {
    type: 'Point',
    coordinates: [0, 0]
  }
};

cardboard.put(feature, 'my-dataset', function(err, result) {
  if (err) throw err;
  result.id === feature.id; // true: the custom id was preserved
});
```

```javascript
// Create a point, then move it.
var feature = {
  type: 'Feature',
  properties: {},
  geometry: {
    type: 'Point',
    coordinates: [0, 0]
  }
};

cardboard.put(feature, 'my-dataset', function(err, result) {
  if (err) throw err;
  result.geometry.coordinates = [1, 1];

  cardboard.put(result, 'my-dataset', function(err, final) {
    if (err) throw err;
    final.geometry.coordinates[0] === 1; // true: the feature was moved
  });
});
```

### del

[index.js:162-174][71]

Remove a single GeoJSON feature

#### Parameters

-   `primary` **[string][57]** the id for a feature
-   `dataset` **[string][57]** the name of the dataset that this feature belongs to
-   `callback` **[function][62]** the callback function to handle the response

#### Examples

```javascript
// Create a point, then delete it
var feature = {
  id: 'my-custom-id',
  type: 'Feature',
  properties: {},
  geometry: {
    type: 'Point',
    coordinates: [0, 0]
  }
};

cardboard.put(feature, 'my-dataset', function(err, result) {
  if (err) throw err;

  cardboard.del(result.id, 'my-dataset', function(err, result) {
    if (err) throw err;
    !!result; // true: the feature was removed
  });
});
```

```javascript
// Attempt to delete a feature that does not exist
cardboard.del('non-existent-feature', 'my-dataset', function(err, result) {
  err.message === 'Feature does not exist'; // true
  !!result; // false: nothing was removed
});
```

### get

[index.js:208-219][72]

Retrieve a single GeoJSON feature

#### Parameters

-   `primary` **[string][57]** the id for a feature
-   `dataset` **[string][57]** the name of the dataset that this feature belongs to
-   `callback` **[function][62]** the callback function to handle the response

#### Examples

```javascript
// Create a point, then retrieve it.
var feature = {
  type: 'Feature',
  properties: {},
  geometry: {
    type: 'Point',
    coordinates: [0, 0]
  }
};

cardboard.put(feature, 'my-dataset', function(err, result) {
  if (err) throw err;
  result.geometry.coordinates = [1, 1];

  cardboard.get(result.id, 'my-dataset', function(err, final) {
    if (err) throw err;
    final === result; // true: the feature was retrieved
  });
});
```

```javascript
// Attempt to retrieve a feature that does not exist
cardboard.get('non-existent-feature', 'my-dataset', function(err, result) {
  err.message === 'Feature non-existent-feature does not exist'; // true
  !!result; // false: nothing was retrieved
});
```

### createTable

[index.js:236-245][73]

Create a DynamoDB table with Cardboard's schema

#### Parameters

-   `tableName` **[string][57]?** the name of the table to create, if not provided, defaults to the tablename defined in client configuration.
-   `callback` **[function][62]** the callback function to handle the response

#### Examples

```javascript
// Create the cardboard table specified by the client config
cardboard.createTable(function(err) {
  if (err) throw err;
});
```

```javascript
// Create the another cardboard table
cardboard.createTable('new-cardboard-table', function(err) {
  if (err) throw err;
});
```

### delDataset

[index.js:274-287][74]

Remove an entire dataset

#### Parameters

-   `dataset` **[string][57]** the name of the dataset
-   `callback` **[function][62]** the callback function to handle the response

### list

[index.js:332-399][75]

List the GeoJSON features that belong to a particular dataset

#### Parameters

-   `dataset` **[string][57]** the name of the dataset
-   `pageOptions` **[object][56]?** pagination options
    -   `pageOptions.start` **[string][57]?** start reading features past the provided id
    -   `pageOptions.maxFeatures` **[number][76]?** maximum number of features to return
-   `callback` **[function][62]?** the callback function to handle the response

#### Examples

```javascript
// List all the features in a dataset
cardboard.list('my-dataset', function(err, collection) {
  if (err) throw err;
  collection.type === 'FeatureCollection'; // true
});
```

```javascript
// Stream all the features in a dataset
cardboard.list('my-dataset')
  .on('data', function(feature) {
    console.log('Got feature: %j', feature);
  })
  .on('end', function() {
    console.log('All done!');
  });
```

```javascript
// List one page with a max of 10 features from a dataset
cardboard.list('my-dataset', { maxFeatures: 10 }, function(err, collection) {
  if (err) throw err;
  collection.type === 'FeatureCollection'; // true
  collection.features.length <= 10; // true
});
```

```javascript
// Paginate through all the features in a dataset
(function list(start) {
  cardabord.list('my-dataset', {
    maxFeatures: 10,
    start: start
  }, function(err, collection) {
    if (err) throw err;
    if (!collection.features.length) return console.log('All done!');
    list(collection.features.slice(-1)[0].id);
  });
})();
```

Returns **[object][56]** a readable stream

### listDatasets

[index.js:411-424][77]

List datasets available in this database

#### Parameters

-   `callback` **[function][62]** the callback function to handle the response

#### Examples

```javascript
cardboard.listDatasets(function(err, datasets) {
  if (err) throw err;
  Array.isArray(datasets); // true
  console.log(datasets[0]); // 'my-dataset'
});
```

### getDatasetInfo

[index.js:447-449][78]

Get cached metadata about a dataset

#### Parameters

-   `dataset` **[string][57]** the name of the dataset
-   `callback` **[function][62]** the callback function to handle the response

#### Examples

```javascript
cardboard.getDatasetInfo('my-dataset', function(err, metadata) {
  if (err) throw err;
  console.log(Object.keys(metadatata));
  // [
  //   'dataset',
  //   'id',
  //   'west',
  //   'south',
  //   'east',
  //   'north',
  //   'count',
  //   'size',
  //   'updated'
  // ]
});
```

### calculateDatasetInfo

[index.js:472-474][79]

Calculate metadata about a dataset

#### Parameters

-   `dataset` **[string][57]** the name of the dataset
-   `callback` **[function][62]** the callback function to handle the response

#### Examples

```javascript
cardboard.calculateDatasetInfo('my-dataset', function(err, metadata) {
  if (err) throw err;
  console.log(Object.keys(metadatata));
  // [
  //   'dataset',
  //   'id',
  //   'west',
  //   'south',
  //   'east',
  //   'north',
  //   'count',
  //   'size',
  //   'updated'
  // ]
});
```

### bboxQuery

[index.js:561-617][80]

Find GeoJSON features that intersect a bounding box

#### Parameters

-   `bbox` **[Array][66]&lt;[number][76]>** the bounding box as `[west, south, east, north]`
-   `dataset` **[string][57]** the name of the dataset
-   `options` **[Object][56]?** Paginiation options. If omitted, the the bbox will
      return the first page, limited to 100 features
    -   `options.maxFeatures` **[number][76]?** maximum number of features to return
    -   `options.start` **[Object][56]?** Exclusive start key to use for loading the next page. This is a feature id.
-   `callback` **[function][62]** the callback function to handle the response

#### Examples

```javascript
var bbox = [-120, 30, -115, 32]; // west, south, east, north
carboard.bboxQuery(bbox, 'my-dataset', function(err, collection) {
  if (err) throw err;
  collection.type === 'FeatureCollection'; // true
});
```

## cardboard.metadata

[index.js:480-480][81]

A module for incremental metadata adjustments

## utils

[lib/utils.js:16-16][82]

A module containing internal utility functions

### resolveFeatures

[lib/utils.js:23-60][83]

Convert a set of backend records into a GeoJSON features

#### Parameters

-   `dynamoRecords` **[Array][66]&lt;[object][56]>** an array of items returned from DynamoDB in simplified JSON format
-   `callback` **[function][62]** a callback function to handle the response

### toDatabaseRecord

[lib/utils.js:77-120][84]

Converts a single GeoJSON feature into backend format

#### Parameters

-   `feature` **[object][56]** a GeoJSON feature
-   `dataset` **[string][57]** the name of the dataset the feature belongs to

Returns **[Array][66]&lt;[object][56]>** the first element is a DynamoDB record suitable for inserting via `dyno.putItem`, the second are parameters suitable for uploading via `s3.putObject`.

### idFromRecord

[lib/utils.js:127-132][85]

Strips database-information from a DynamoDB record's id

#### Parameters

-   `record` **[object][56]** a DynamoDB record

Returns **[string][57]** id - the feature's identifier

## cardboard.batch

[lib/batch.js:23-23][86]

A module for batch requests

[1]: #cardboard

[2]: #parameters

[3]: #examples

[4]: #addfeature

[5]: #parameters-1

[6]: #updatefeature

[7]: #parameters-2

[8]: #deletefeature

[9]: #parameters-3

[10]: #applychanges

[11]: #parameters-4

[12]: #put

[13]: #parameters-5

[14]: #remove

[15]: #parameters-6

[16]: #cardboard-1

[17]: #put-1

[18]: #parameters-7

[19]: #examples-1

[20]: #del

[21]: #parameters-8

[22]: #examples-2

[23]: #get

[24]: #parameters-9

[25]: #examples-3

[26]: #createtable

[27]: #parameters-10

[28]: #examples-4

[29]: #deldataset

[30]: #parameters-11

[31]: #list

[32]: #parameters-12

[33]: #examples-5

[34]: #listdatasets

[35]: #parameters-13

[36]: #examples-6

[37]: #getdatasetinfo

[38]: #parameters-14

[39]: #examples-7

[40]: #calculatedatasetinfo

[41]: #parameters-15

[42]: #examples-8

[43]: #bboxquery

[44]: #parameters-16

[45]: #examples-9

[46]: #cardboardmetadata

[47]: #utils

[48]: #resolvefeatures

[49]: #parameters-17

[50]: #todatabaserecord

[51]: #parameters-18

[52]: #idfromrecord

[53]: #parameters-19

[54]: #cardboardbatch

[55]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L37-L620 "Source code on GitHub"

[56]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[57]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[58]: https://github.com/mapbox/dyno

[59]: http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/S3.html

[60]: #cardboard

[61]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L501-L503 "Source code on GitHub"

[62]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[63]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L515-L517 "Source code on GitHub"

[64]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L527-L529 "Source code on GitHub"

[65]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L539-L541 "Source code on GitHub"

[66]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[67]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/lib/batch.js#L33-L80 "Source code on GitHub"

[68]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/lib/batch.js#L90-L111 "Source code on GitHub"

[69]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L55-L55 "Source code on GitHub"

[70]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L115-L128 "Source code on GitHub"

[71]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L162-L174 "Source code on GitHub"

[72]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L208-L219 "Source code on GitHub"

[73]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L236-L245 "Source code on GitHub"

[74]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L274-L287 "Source code on GitHub"

[75]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L332-L399 "Source code on GitHub"

[76]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[77]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L411-L424 "Source code on GitHub"

[78]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L447-L449 "Source code on GitHub"

[79]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L472-L474 "Source code on GitHub"

[80]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L561-L617 "Source code on GitHub"

[81]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/index.js#L480-L480 "Source code on GitHub"

[82]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/lib/utils.js#L16-L16 "Source code on GitHub"

[83]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/lib/utils.js#L23-L60 "Source code on GitHub"

[84]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/lib/utils.js#L77-L120 "Source code on GitHub"

[85]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/lib/utils.js#L127-L132 "Source code on GitHub"

[86]: https://github.com/mapbox/cardboard/blob/5d8e926e0e2d87c33a8079d2ba742bb93a1d8211/lib/batch.js#L23-L23 "Source code on GitHub"
